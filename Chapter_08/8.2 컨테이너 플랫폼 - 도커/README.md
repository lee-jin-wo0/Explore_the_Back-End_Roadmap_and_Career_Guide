# 8.2 컨테이너 플랫폼 : 도커

## 8.2.1 도커의 개념

**도커(Docker)** : 컨테이너 기술을 이용해 웹 애플리케이션을 배포하고 실행하는 오픈 소스 플랫폼.

도커는 웹 애플리케이션을 실행하는 데 필요한 모든 환경을 패키징해 컨테이너 이미지를 만들고, 이 이미지를 이용해 컨테이너를 생성.

도커는 컨테이너 기술의 장점을 최대한 활용할 수 있도록 컨테이너 간 통신을 위한 네트워크 구성 기능, 여러 컨테이너를 동시에 관리하기 위한 오케스트레이션 기능, 컨테이너 이미지를 저장하고 관리하는 기능 등을 제공.

가상 머신과 달리 호스트 운영체제를 공유하기 때문에 빠르고 가벼움.

하지만 컨테이너 내부에 설치된 웹 애플리케이션이 호스트 운영체제를 공유하므로 호스트 운영체제의 제한을 받을 수 있다는 것이 장점.

<br />

## 8.2.2 도커의 구조

도커의 구조는 크게 클라이언트와 서버로 나뉨.

사용자가 도커 클라이언트를 통해 'docker'로 시작되는 도커 명령어를 입력하면 도커 호스트(도커 서버)의 도커 데몬(도커 엔진)에 명령이 전달돼 컨테이너 생성 및 실행, 컨테이너 이미지 관리 등의 작업이 수행됨.

도커 클라이언트와 도커 데몬을 API를 통해 요청을 주고 받음.

도커 클라이언트는 개발자가 API를 사용해 명령을 내릴 수 있도록 CLI(Command Line Interface) 환경을 제공.

도커 데몬은 API로 들어온 명령을 수행하는데, 이때 도커드(Dockerd)라는 프로세스를 통해 동작. 도커드는 컨테이너와 컨테이너 이미지 관리의 주체.

<br />

도커가 대중화되면서 최근에는 도커 허브(Docker Hub)와 같은 컨테이너 레지스트리(Container Registry, 컨테이너 이미지 저장소)도 등장. 이를 통해 다양한 웹 애플리케이션과 미들웨어, 프레임워크 등이 컨테이너 이미지로 제공돼 사용자가 웹 애플리케이션을 쉽게 배포하고 실행할 수 있게 됨.

<br />

## 8.2.3 컨테이너 이미지

컨테이너 이미지 : 컨테이너 실행에 필요한 모든 것이 포함된 패키지, 웹 애플리케이션 실행에 필요한 모든 소스 코드, 런타임, 라이브러리, 환경 변수 등의 구성 요소가 들어 있음.

컨테이너 이미지는 한 번 만들면 다른 서버 환경에서도 동일하게 사용할 수 있어 호환성이 좋음.

도커 이미지는 **도커파일(Dockerfile)**이라는 텍스트 파일을 이용해 만듬.

도커 파일에는 웹 애플리케이션의 구성과 실행 방법을 정의하는 명령어가 작성돼 있으며, 이를 빌드하면 도커 이미지가 생성되고 도커 이미지를 실행하면 컨테이너가 실행됨.

컨테이너 이미지는 개발자나 운영 팀에많은 이점을 안겨줌. 컨테이너 이미지를 사용하면 웹 애플리케이션 배포와 관리가 훨씬 쉬워지고, 어떤 서버 환경에서 웹 애플리케이션을 실행하더라도 일관된 결과를 얻을 수 있음.

<br />

## 8.2.4 컨테이너의 주요 명령어

컨테이너와 관련된 주요 명령어는 도커에서 사용하므로 도커 명령어라고 함.  명령어를 이용하여 도커 컨테이너를 생성, 실행, 관리, 모니터링함.

<br />

:black_circle: docker run : 도커 컨테이너를 생성하고 실행하는 명령어.

컨테이너 이미지를 기반으로 컨테이너를 만들고, 옵션 값을 입력해 컨테이너 실행 시 여러 조건을 설정.

````dockerfile
docker run [컨테이너_이미지_이름] [옵션]
````

<br />

:black_circle: docker start : 중지된 컨테이너를 시작하는 명령어. 컨테이너가 중지된 상태에서 시작하고 싶을 때 사용.

```dockerfile
docker start 컨테이너_이름
```

<br />

:black_circle: docker stop : 실행 중인 컨테이너를 중지하는 명령어.

컨테이너를 안전하게 중지하고 종료.

``` dockerfile
docker stop 컨테이너_이름
```

<br />

:black_circle: docker restart : 실행 중인 컨테이너를 재시작하는 명령어.

컨테이너를 중지하고 다시 시작.

```dockerfile
docker restart 컨테이너_이름
```

<br />

:black_circle: docker rm : 컨테이너를 삭제하는 명령어.

컨테이너를 중지해야만 삭제할 수 있음.

```dockerfile
docker rm 컨테이너_이름
```

<br />

:black_circle: docker ps : 실행 중인 컨테이너 목록을 보여주는 명령어.

현재 실행 중인 컨테이너의 상태를 확인할 수 있음.

````dockerfile
docker ps
````

<br />

:black_circle: docker logs : 컨테이너의 로그를 확인하는 명령어.

컨테이너에서 바생한 로그 메시지를 보여주므로 디버깅 및 모니터링할 때 사용.

````dockerfile
docker logs 컨테이너_이름
````

<br />

:black_circle: docker exec : 실행 중인 컨테이너 내부에서 명령을 실행.

컨테이너에 접속해 특정 명령을 실행하거나 컨테이너끼리 상호작용할 수 있음.

```dockerfile
docker exec 옵션 컨테이너_이름(또는 ID) 실행할_명령
```

<br />

:black_circle: docker build : 도커 이미지를 생성하는 명령어.

도커 파일을 빌드해 이미지를 만들고 태그를 지정(해당 도커 이미지의 버전 지정)함.

```dockerfile
docker build -t 도커_이미지_이름:tag
```

<br />

:black_circle: docker pull : 도커 이미지를 다운로드하는 명령어.

도커 허브와 같은 도커 이미지 저장소에서 도커 이미지를 가져옴.

```dockerfile
docker pull 도커_이미지_이름:tag
```

<br />

## 8.2.5 컨테이너 실행 과정

도커에서 컨테이너로 'Hello from Docker!' 라는 메시지를 출력하는 웹 애플리케이션의 실행 과정. 여기서 사용하는 도커 이미지의 이름은 hello-world이며, 도커 클라이언트의 명령은 `docker run hello-world`임.

:one: 도커가 실행되면서 도커 데몬이 시작됨.

:two: 도커 데몬은 hello-world라는 도커 이미지를 로컬 저장소에서 찾음. 이미지가 없는 경우 도커 허브에서 해당 이미지를 찾아 다운로드함.

:three: 도커 데몬은 찾은 이미지를 기반으로 새로운 컨테이너를 생성하고 실행.

:four: 컨테이너가 실행되면 hello-world 이미지에 포함된 실행 파일이 동작하고, 'Hello from Docker!'라는 메시지와 함께 몇 가지 정보를 출력.

:five: 명령 실행을 완료하면 컨테이너가 종료. 